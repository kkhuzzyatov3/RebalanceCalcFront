<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ü–æ—Ä—Ç—Ñ–µ–ª—å–Ω—ã–π –∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä</title>
    <style>
        /* –û–±—â–∏–µ —Å—Ç–∏–ª–∏ –¥–ª—è –≤—Å–µ—Ö —Å—Ç—Ä–∞–Ω–∏—Ü */
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: Arial, sans-serif;
        }

        body {
            background-color: #f5f5f5;
            color: #333;
            line-height: 1.6;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        /* –°—Ç–∏–ª–∏ –¥–ª—è –∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä–∞ */
        .calc-page {
            display: block;
        }

        .upper-block {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            padding: 15px;
            background-color: #fff;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .logo-icon {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .site-name {
            font-size: 1.2rem;
            font-weight: bold;
        }

        .buttons-container {
            display: flex;
            gap: 20px;
        }

        .buttons-column {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .allocation-block {
            background-color: #fff;
            padding: 20px;
            margin-bottom: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .allocation-title {
            margin-bottom: 15px;
            font-size: 1.2rem;
            color: #2c3e50;
        }

        .add-asset-btn {
            padding: 8px 16px;
            background-color: #3498db;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            transition: background-color 0.3s;
        }

        .add-asset-btn:hover {
            background-color: #2980b9;
        }

        .assets-list {
            margin-top: 15px;
        }

        .asset-item {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 10px;
            padding: 10px;
            background-color: #f9f9f9;
            border-radius: 4px;
        }

        .asset-label {
            min-width: 120px;
        }

        .asset-input {
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 4px;
            flex-grow: 1;
        }

        .remove-asset {
            background-color: #e74c3c;
            color: white;
            border: none;
            border-radius: 4px;
            padding: 5px 10px;
            cursor: pointer;
        }

        .action-buttons {
            display: flex;
            gap: 15px;
            margin-top: 30px;
            flex-wrap: wrap;
        }

        .action-btn {
            padding: 10px 20px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s;
        }

        .save-btn {
            background-color: #2ecc71;
            color: white;
        }

        .save-btn:hover {
            background-color: #27ae60;
        }

        .load-btn {
            background-color: #f39c12;
            color: white;
        }

        .load-btn:hover {
            background-color: #d35400;
        }

        .calc-btn {
            background-color: #9b59b6;
            color: white;
        }

        .calc-btn:hover {
            background-color: #8e44ad;
        }

        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: rgba(0,0,0,0.5);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 1000;
        }

        .modal {
            background-color: #fff;
            padding: 25px;
            border-radius: 8px;
            width: 90%;
            max-width: 800px;
            max-height: 80vh;
            overflow-y: auto;
            box-shadow: 0 4px 20px rgba(0,0,0,0.2);
        }

        .modal-title {
            margin-bottom: 20px;
            text-align: center;
            color: #2c3e50;
        }

        .dev-table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 20px;
        }

        .dev-table th, .dev-table td {
            padding: 12px;
            border: 1px solid #ddd;
            text-align: left;
        }

        .dev-table th {
            background-color: #f2f2f2;
            font-weight: bold;
        }

        .dev-link {
            color: #3498db;
            text-decoration: none;
        }

        .dev-link:hover {
            text-decoration: underline;
        }

        .close-btn {
            display: block;
            margin: 0 auto;
            padding: 8px 20px;
            background-color: #95a5a6;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
        }

        .close-btn:hover {
            background-color: #7f8c8d;
        }

        .output-content {
            white-space: pre-line;
            padding: 15px;
            background-color: #f9f9f9;
            border-radius: 4px;
            margin-bottom: 20px;
            font-family: monospace;
            overflow-x: auto;
        }

        /* –°—Ç–∏–ª–∏ –¥–ª—è —Å—Ç—Ä–∞–Ω–∏—Ü –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –∏ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ */
        .auth-page {
            display: none;
            background-color: #f5f5f5;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            padding: 20px;
        }

        .auth-container {
            background-color: white;
            border-radius: 15px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            width: 100%;
            max-width: 400px;
            padding: 30px;
            text-align: center;
        }

        .auth-header {
            margin-bottom: 30px;
        }

        .site-icon {
            width: 60px;
            height: 60px;
            margin-bottom: 15px;
            background-color: #eee;
            border-radius: 50%;
            display: inline-flex;
            justify-content: center;
            align-items: center;
            font-size: 24px;
        }

        .site-name {
            font-size: 24px;
            font-weight: bold;
            color: #333;
        }

        .input-group {
            margin-bottom: 20px;
            text-align: left;
        }

        label {
            display: block;
            margin-bottom: 8px;
            font-weight: bold;
            color: #555;
        }

        .input-wrapper {
            position: relative;
        }

        input {
            width: 100%;
            padding: 12px 15px;
            border: 1px solid #ddd;
            border-radius: 8px;
            font-size: 16px;
            transition: border-color 0.3s;
        }

        input:focus {
            outline: none;
            border-color: #4a90e2;
        }

        .password-toggle {
            position: absolute;
            right: 10px;
            top: 50%;
            transform: translateY(-50%);
            background: none;
            border: none;
            cursor: pointer;
            color: #777;
        }

        .login-btn, .signup-btn {
            width: 100%;
            padding: 12px;
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            transition: background-color 0.3s;
            margin-top: 10px;
        }

        .login-btn {
            background-color: #4a90e2;
        }

        .login-btn:hover {
            background-color: #3a7bc8;
        }

        .signup-btn {
            background-color: #4CAF50;
        }

        .signup-btn:hover {
            background-color: #3e8e41;
        }

        .register-link, .login-link {
            margin-top: 20px;
            color: #666;
        }

        .register-link a, .login-link a {
            color: #4a90e2;
            text-decoration: none;
            font-weight: bold;
        }

        .register-link a:hover, .login-link a:hover {
            text-decoration: underline;
        }

        /* –ê–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å */
        @media (max-width: 768px) {
            .upper-block {
                flex-direction: column;
                gap: 15px;
            }
            
            .buttons-container {
                width: 100%;
                justify-content: space-between;
            }
            
            .buttons-column {
                width: 48%;
            }
            
            .action-buttons {
                flex-direction: column;
            }
            
            .action-buttons button {
                width: 100%;
            }
            
            .asset-item {
                flex-direction: column;
                align-items: flex-start;
            }
            
            .asset-input {
                width: 100%;
            }
            
            .dev-table {
                display: block;
                overflow-x: auto;
            }
        }
    </style>
</head>
<body>
    <!-- –°—Ç—Ä–∞–Ω–∏—Ü–∞ –∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä–∞ -->
    <div id="calc-page" class="calc-page container">
        <!-- –í–µ—Ä—Ö–Ω–∏–π –±–ª–æ–∫ —Å –ª–æ–≥–æ –∏ –∫–Ω–æ–ø–∫–∞–º–∏ -->
        <div class="upper-block">
            <div class="logo">
                <img src="site_icon.png" class="logo-icon">
                <div class="site-name">–ü–æ—Ä—Ç—Ñ–µ–ª—å–Ω—ã–π –∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä</div>
            </div>
            <div class="buttons-container">
                <div class="buttons-column">
                    <button id="login-btn" class="action-btn">–í—Ö–æ–¥</button>
                    <button id="history-btn" class="action-btn">–ò—Å—Ç–æ—Ä–∏—è</button>
                </div>
                <div class="buttons-column">
                    <button id="developers-btn" class="action-btn">–†–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∏</button>
                </div>
            </div>
        </div>

        <!-- –ë–ª–æ–∫ —Ç–µ–∫—É—â–µ–π –∞–ª–ª–æ–∫–∞—Ü–∏–∏ -->
        <div class="allocation-block">
            <h2 class="allocation-title">–¢–µ–∫—É—â–∞—è –∞–ª–ª–æ–∫–∞—Ü–∏—è</h2>
            <button id="add-current-asset" class="add-asset-btn">–î–æ–±–∞–≤–∏—Ç—å –∞–∫—Ç–∏–≤</button>
            <div class="assets-list" id="current-assets"></div>
        </div>

        <!-- –ë–ª–æ–∫ —Ü–µ–ª–µ–≤–æ–π –∞–ª–ª–æ–∫–∞—Ü–∏–∏ -->
        <div class="allocation-block">
            <h2 class="allocation-title">–¶–µ–ª–µ–≤—ã–µ –ø—Ä–æ–ø–æ—Ä—Ü–∏–∏ –∞–ª–ª–æ–∫–∞—Ü–∏–∏</h2>
            <button id="add-target-asset" class="add-asset-btn">–î–æ–±–∞–≤–∏—Ç—å –∞–∫—Ç–∏–≤</button>
            <div class="assets-list" id="target-assets"></div>
        </div>

        <!-- –ë–ª–æ–∫ –∫–Ω–æ–ø–æ–∫ –¥–µ–π—Å—Ç–≤–∏–π -->
        <div class="action-buttons">
            <button id="save-btn" class="action-btn save-btn">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –¥–∞–Ω–Ω—ã–µ</button>
            <button id="load-btn" class="action-btn load-btn">–ó–∞–≥—Ä—É–∑–∏—Ç—å –¥–∞–Ω–Ω—ã–µ</button>
            <button id="calc-btn" class="action-btn calc-btn">–ü–æ—Å—á–∏—Ç–∞—Ç—å —Ä–µ–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫—É</button>
        </div>
    </div>

    <!-- –°—Ç—Ä–∞–Ω–∏—Ü–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ -->
    <div id="signin-page" class="auth-page">
        <div class="auth-container">
            <div class="auth-header">
                <img src="site_icon.png" class="site-icon">
                <div class="site-name">–ü–æ—Ä—Ç—Ñ–µ–ª—å–Ω—ã–π –∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä</div>
            </div>
            
            <div class="input-group">
                <label for="signin-email">–ü–æ—á—Ç–∞</label>
                <div class="input-wrapper">
                    <input type="email" id="signin-email" placeholder="–í–≤–µ–¥–∏—Ç–µ –≤–∞—à—É –ø–æ—á—Ç—É" required>
                </div>
            </div>
            
            <div class="input-group">
                <label for="signin-password">–ü–∞—Ä–æ–ª—å</label>
                <div class="input-wrapper">
                    <input type="password" id="signin-password" placeholder="–í–≤–µ–¥–∏—Ç–µ –≤–∞—à –ø–∞—Ä–æ–ª—å" required>
                    <button class="password-toggle" type="button" onclick="togglePasswordVisibility('signin-password')">üëÅÔ∏è</button>
                </div>
            </div>
            
            <button class="login-btn" onclick="login()">–í–æ–π—Ç–∏</button>
            
            <div class="register-link">
                –ï—â–µ –Ω–µ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω—ã? <a href="#" onclick="showPage('signup-page')">–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–π—Ç–µ—Å—å</a>
            </div>
        </div>
    </div>

    <!-- –°—Ç—Ä–∞–Ω–∏—Ü–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ -->
    <div id="signup-page" class="auth-page">
        <div class="auth-container">
            <div class="auth-header">
                <img src="site_icon.png" class="site-icon">
                <div class="site-name">–ü–æ—Ä—Ç—Ñ–µ–ª—å–Ω—ã–π –∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä</div>
            </div>
            
            <div class="input-group">
                <label for="signup-email">–ü–æ—á—Ç–∞</label>
                <div class="input-wrapper">
                    <input type="email" id="signup-email" placeholder="–í–≤–µ–¥–∏—Ç–µ –≤–∞—à—É –ø–æ—á—Ç—É" required>
                </div>
            </div>
            
            <div class="input-group">
                <label for="signup-password">–ü–∞—Ä–æ–ª—å</label>
                <div class="input-wrapper">
                    <input type="password" id="signup-password" placeholder="–ü—Ä–∏–¥—É–º–∞–π—Ç–µ –ø–∞—Ä–æ–ª—å" required>
                    <button class="password-toggle" type="button" onclick="togglePasswordVisibility('signup-password')">üëÅÔ∏è</button>
                </div>
            </div>
            
            <button class="signup-btn" onclick="signup()">–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è</button>
            
            <div class="login-link">
                –£–∂–µ –µ—Å—Ç—å –∞–∫–∫–∞—É–Ω—Ç? <a href="#" onclick="showPage('signin-page')">–í–æ–π–¥–∏—Ç–µ</a>
            </div>
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω—ã–µ –æ–∫–Ω–∞ -->
    <div id="developers-modal" class="modal-overlay">
        <div class="modal">
            <h2 class="modal-title">–†–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∏</h2>
            <table class="dev-table">
                <thead>
                    <tr>
                        <th>–†–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫</th>
                        <th>–ù–∞–≤—ã–∫–∏</th>
                        <th>Telegram</th>
                        <th>–ü–æ—Ä—Ç—Ñ–æ–ª–∏–æ</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>–•–£–ó–ó–Ø–¢–û–í –ö–ê–ú–ò–õ–¨</td>
                        <td>backend (Golang, sql, docker)</td>
                        <td><a href="https://t.me/kkhuzzyatov" class="dev-link" target="_blank">@kkhuzzyatov</a></td>
                        <td><a href="https://github.com/kkhuzzyatov" class="dev-link" target="_blank">github.com/kkhuzzyatov</a></td>
                    </tr>
                </tbody>
            </table>
            <button id="close-dev-modal" class="close-btn">–ó–∞–∫—Ä—ã—Ç—å</button>
        </div>
    </div>

    <div id="output-modal" class="modal-overlay">
        <div class="modal">
            <h2 class="modal-title" id="output-title">–†–µ–∑—É–ª—å—Ç–∞—Ç</h2>
            <div class="output-content" id="output-content"></div>
            <button id="close-output-modal" class="close-btn">–ó–∞–∫—Ä—ã—Ç—å</button>
        </div>
    </div>

    <script>
        // –ì–ª–æ–±–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö
        let currentAssets = [];
        let targetAssets = [];
        let userData = {
            email: '',
            password: ''
        };

        // DOM —ç–ª–µ–º–µ–Ω—Ç—ã
        const calcPage = document.getElementById('calc-page');
        const signinPage = document.getElementById('signin-page');
        const signupPage = document.getElementById('signup-page');
        const loginBtn = document.getElementById('login-btn');
        const historyBtn = document.getElementById('history-btn');
        const developersBtn = document.getElementById('developers-btn');
        const addCurrentAssetBtn = document.getElementById('add-current-asset');
        const addTargetAssetBtn = document.getElementById('add-target-asset');
        const saveBtn = document.getElementById('save-btn');
        const loadBtn = document.getElementById('load-btn');
        const calcBtn = document.getElementById('calc-btn');
        const currentAssetsContainer = document.getElementById('current-assets');
        const targetAssetsContainer = document.getElementById('target-assets');
        const developersModal = document.getElementById('developers-modal');
        const closeDevModalBtn = document.getElementById('close-dev-modal');
        const outputModal = document.getElementById('output-modal');
        const outputTitle = document.getElementById('output-title');
        const outputContent = document.getElementById('output-content');
        const closeOutputModalBtn = document.getElementById('close-output-modal');

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
        document.addEventListener('DOMContentLoaded', function() {
            // –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä
            showPage('calc-page');
            
            // –î–æ–±–∞–≤–ª—è–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–æ–±—ã—Ç–∏–π
            setupEventListeners();
            
            // –î–ª—è –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏ –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å —Ç–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ
            addTestData();
        });

        function setupEventListeners() {
            // –ö–Ω–æ–ø–∫–∏ –≤–µ—Ä—Ö–Ω–µ–≥–æ –±–ª–æ–∫–∞
            loginBtn.addEventListener('click', function() {
                showPage('signin-page');
            });
            
            historyBtn.addEventListener('click', handleHistory);
            developersBtn.addEventListener('click', showDevelopersModal);
            closeDevModalBtn.addEventListener('click', hideDevelopersModal);
            
            // –ö–Ω–æ–ø–∫–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –∞–∫—Ç–∏–≤–æ–≤
            addCurrentAssetBtn.addEventListener('click', function() {
                addAssetInput(currentAssetsContainer, 'current');
            });
            
            addTargetAssetBtn.addEventListener('click', function() {
                addAssetInput(targetAssetsContainer, 'target');
            });
            
            // –ö–Ω–æ–ø–∫–∏ –¥–µ–π—Å—Ç–≤–∏–π
            saveBtn.addEventListener('click', handleSave);
            loadBtn.addEventListener('click', handleLoad);
            calcBtn.addEventListener('click', handleCalculate);
            
            // –ó–∞–∫—Ä—ã—Ç–∏–µ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
            closeOutputModalBtn.addEventListener('click', hideOutputModal);
            
            // –ó–∞–∫—Ä—ã—Ç–∏–µ –º–æ–¥–∞–ª—å–Ω—ã—Ö –æ–∫–æ–Ω –ø—Ä–∏ –∫–ª–∏–∫–µ –≤–Ω–µ –∫–æ–Ω—Ç–µ–Ω—Ç–∞
            developersModal.addEventListener('click', function(e) {
                if (e.target === developersModal) {
                    hideDevelopersModal();
                }
            });
            
            outputModal.addEventListener('click', function(e) {
                if (e.target === outputModal) {
                    hideOutputModal();
                }
            });
            
            // –û–±—Ä–∞–±–æ—Ç–∫–∞ –Ω–∞–∂–∞—Ç–∏—è Enter –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
            document.getElementById('signin-email').addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    login();
                }
            });
            
            document.getElementById('signin-password').addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    login();
                }
            });
            
            // –û–±—Ä–∞–±–æ—Ç–∫–∞ –Ω–∞–∂–∞—Ç–∏—è Enter –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏
            document.getElementById('signup-email').addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    signup();
                }
            });
            
            document.getElementById('signup-password').addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    signup();
                }
            });
        }

        function showPage(pageId) {
            // –°–∫—Ä—ã–≤–∞–µ–º –≤—Å–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
            calcPage.style.display = 'none';
            signinPage.style.display = 'none';
            signupPage.style.display = 'none';
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –Ω—É–∂–Ω—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É
            if (pageId === 'calc-page') {
                calcPage.style.display = 'block';
            } else {
                document.getElementById(pageId).style.display = 'flex';
            }
        }

        function addTestData() {
            // –î–æ–±–∞–≤–ª—è–µ–º —Ç–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ –¥–ª—è –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏
            if (currentAssetsContainer.children.length === 0) {
                addAssetInput(currentAssetsContainer, 'current', 'TMOS', '1000');
                addAssetInput(currentAssetsContainer, 'current', 'SBER', '500');
                addAssetInput(currentAssetsContainer, 'current', 'RUB', '10000');
                
                addAssetInput(targetAssetsContainer, 'target', 'TMOS', '20');
                addAssetInput(targetAssetsContainer, 'target', 'SBER', '40');
                addAssetInput(targetAssetsContainer, 'target', 'RUB', '40');
            }
        }

        function togglePasswordVisibility(inputId) {
            const passwordInput = document.getElementById(inputId);
            const toggleButton = passwordInput.nextElementSibling;
            
            if (passwordInput.type === 'password') {
                passwordInput.type = 'text';
                toggleButton.textContent = 'üëÅÔ∏è';
            } else {
                passwordInput.type = 'password';
                toggleButton.textContent = 'üëÅÔ∏è';
            }
        }

        async function login() {
            const email = document.getElementById('signin-email').value;
            const password = document.getElementById('signin-password').value;
            
            if (!email || !password) {
                alert('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –∑–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –ø–æ–ª—è');
                return;
            }
            
            const data = {
                email: email,
                password: password
            };
            
            try {
                const response = await fetch('http://194.67.205.242:8080/finduser', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(data)
                });
                
                if (!response.ok) {
                    throw new Error('Network response was not ok');
                }
                
                const result = await response.json();
                
                if (result === false) {
                    alert('–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –Ω–∞–π–¥–µ–Ω');
                } else if (result === true) {
                    // –°–æ—Ö—Ä–∞–Ω—è–µ–º –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
                    userData.email = email;
                    userData.password = password;
                    localStorage.setItem('userEmail', email);
                    localStorage.setItem('userPassword', password);
                    
                    // –ü–µ—Ä–µ—Ö–æ–¥–∏–º –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É –∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä–∞
                    showPage('calc-page');
                }
            } catch (error) {
                console.error('Error:', error);
                alert('–ù–µ –ø–æ–ª—É—á–µ–Ω –æ—Ç–≤–µ—Ç –æ—Ç —Å–µ—Ä–≤–µ—Ä–∞');
            }
        }

        async function signup() {
            const email = document.getElementById('signup-email').value;
            const password = document.getElementById('signup-password').value;
            
            if (!email || !password) {
                alert('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –∑–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –ø–æ–ª—è');
                return;
            }
            
            // –ü—Ä–æ—Å—Ç–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è email
            if (!email.includes('@') || !email.includes('.')) {
                alert('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤–≤–µ–¥–∏—Ç–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π email');
                return;
            }
            
            // –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–ª–æ–∂–Ω–æ—Å—Ç–∏ –ø–∞—Ä–æ–ª—è
            if (password.length < 6) {
                alert('–ü–∞—Ä–æ–ª—å –¥–æ–ª–∂–µ–Ω —Å–æ–¥–µ—Ä–∂–∞—Ç—å –º–∏–Ω–∏–º—É–º 6 —Å–∏–º–≤–æ–ª–æ–≤');
                return;
            }
            
            const data = {
                email: email,
                password: password
            };
            
            try {
                const response = await fetch('http://194.67.205.242:8080/createuser', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(data)
                });
                
                if (!response.ok) {
                    throw new Error('Network response was not ok');
                }
                
                const result = await response.json();
                
                if (result === true) {
                    // –°–æ—Ö—Ä–∞–Ω—è–µ–º –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
                    userData.email = email;
                    userData.password = password;
                    localStorage.setItem('userEmail', email);
                    localStorage.setItem('userPassword', password);
                    
                    // –ü–µ—Ä–µ—Ö–æ–¥–∏–º –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É –∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä–∞
                    showPage('calc-page');
                } else {
                    alert('–ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞ –ø—Ä–∏ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏');
                }
            } catch (error) {
                console.error('Error:', error);
                alert('–ù–µ –ø–æ–ª—É—á–µ–Ω –æ—Ç–≤–µ—Ç –æ—Ç —Å–µ—Ä–≤–µ—Ä–∞');
            }
        }

        function handleHistory() {
            if (!userData.email) {
                alert('–î–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –∏—Å—Ç–æ—Ä–∏–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –≤–æ–π—Ç–∏ –≤ —Å–∏—Å—Ç–µ–º—É');
                showPage('signin-page');
                return;
            }
            
            showOutputModal('–ò—Å—Ç–æ—Ä–∏—è –æ–ø–µ—Ä–∞—Ü–∏–π', '–ò—Å—Ç–æ—Ä–∏—è –æ–ø–µ—Ä–∞—Ü–∏–π –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–Ω–∞ –ø–æ—Å–ª–µ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –±—ç–∫–µ–Ω–¥–∞.');
        }

        function showDevelopersModal() {
            developersModal.style.display = 'flex';
        }

        function hideDevelopersModal() {
            developersModal.style.display = 'none';
        }

        function showOutputModal(title, content) {
            outputTitle.textContent = title;
            outputContent.textContent = content;
            outputModal.style.display = 'flex';
        }

        function hideOutputModal() {
            outputModal.style.display = 'none';
        }

        function addAssetInput(container, type, ticker = '', value = '') {
            const assetId = Date.now();
            const assetItem = document.createElement('div');
            assetItem.className = 'asset-item';
            assetItem.dataset.id = assetId;
            
            assetItem.innerHTML = `
                <span class="asset-label">–¢–∏–∫–µ—Ä:</span>
                <input type="text" class="asset-input ticker" value="${ticker}" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: TMOS">
                <span class="asset-label">${type === 'current' ? '–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ (—à—Ç—É–∫):' : '–ü—Ä–æ—Ü–µ–Ω—Ç –æ—Ç –∫–∞–ø–∏—Ç–∞–ª–∞:'}</span>
                <input type="number" class="asset-input value" value="${value}" placeholder="${type === 'current' ? '1000' : '20'}">
                <button class="remove-asset">–£–¥–∞–ª–∏—Ç—å</button>
            `;
            
            container.appendChild(assetItem);
            
            // –î–æ–±–∞–≤–ª—è–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –¥–ª—è –∫–Ω–æ–ø–∫–∏ —É–¥–∞–ª–µ–Ω–∏—è
            const removeBtn = assetItem.querySelector('.remove-asset');
            removeBtn.addEventListener('click', function() {
                container.removeChild(assetItem);
                updateAssetsArray(type);
            });
            
            // –î–æ–±–∞–≤–ª—è–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–π –¥–ª—è –∏–Ω–ø—É—Ç–æ–≤
            const inputs = assetItem.querySelectorAll('.asset-input');
            inputs.forEach(input => {
                input.addEventListener('change', function() {
                    updateAssetsArray(type);
                });
            });
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –º–∞—Å—Å–∏–≤ –∞–∫—Ç–∏–≤–æ–≤
            updateAssetsArray(type);
        }

        function updateAssetsArray(type) {
            const container = type === 'current' ? currentAssetsContainer : targetAssetsContainer;
            const assets = [];
            
            const assetItems = container.querySelectorAll('.asset-item');
            assetItems.forEach(item => {
                const ticker = item.querySelector('.ticker').value.trim();
                const value = item.querySelector('.value').value.trim();
                
                if (ticker && value) {
                    assets.push({
                        ticker: ticker,
                        value: type === 'current' ? parseInt(value) || 0 : parseFloat(value) || 0
                    });
                }
            });
            
            if (type === 'current') {
                currentAssets = assets;
            } else {
                targetAssets = assets;
            }
            
            console.log(`${type === 'current' ? '–¢–µ–∫—É—â–∏–µ' : '–¶–µ–ª–µ–≤—ã–µ'} –∞–∫—Ç–∏–≤—ã:`, assets);
        }

        function prepareSaveData() {
            return {
                email: userData.email || 'example@email.com',
                password: userData.password || 'password123',
                cur_allocation: formatAllocation(currentAssets),
                target_allocation: formatAllocation(targetAssets)
            };
        }

        function formatAllocation(assets) {
            return assets.map(asset => 
                `${asset.ticker}=${asset.value}`
            ).join(';');
        }

        function parseAllocation(str) {
            return str.split(';').map(item => {
                const [ticker, value] = item.split('=');
                return { ticker, value: parseFloat(value) || 0 };
            });
        }

        function handleSave() {
            if (!userData.email) {
                alert('–î–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –≤–æ–π—Ç–∏ –≤ —Å–∏—Å—Ç–µ–º—É');
                showPage('signin-page');
                return;
            }
            
            const data = prepareSaveData();
            console.log('–û—Ç–ø—Ä–∞–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è:', data);
            
            // –í —Ä–µ–∞–ª—å–Ω–æ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ –∑–¥–µ—Å—å –±—ã–ª –±—ã fetch –∑–∞–ø—Ä–æ—Å
            // simulateApiCall('save', data);
            
            showOutputModal('–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö', `–î–∞–Ω–Ω—ã–µ —É—Å–ø–µ—à–Ω–æ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã:\n\nEmail: ${data.email}\n\n–¢–µ–∫—É—â–∏–µ –∞–∫—Ç–∏–≤—ã:\n${data.cur_allocation}\n\n–¶–µ–ª–µ–≤—ã–µ –∞–∫—Ç–∏–≤—ã:\n${data.target_allocation}`);
        }

        function handleLoad() {
            if (!userData.email) {
                alert('–î–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –≤–æ–π—Ç–∏ –≤ —Å–∏—Å—Ç–µ–º—É');
                showPage('signin-page');
                return;
            }
            
            const data = prepareSaveData();
            console.log('–ó–∞–ø—Ä–æ—Å –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏:', data);
            
            // –í —Ä–µ–∞–ª—å–Ω–æ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ –∑–¥–µ—Å—å –±—ã–ª –±—ã fetch –∑–∞–ø—Ä–æ—Å
            // simulateApiCall('load', data);
            
            // –î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
            const demoData = {
                cur_allocation: "TMOS=1000;SBER=500;RUB=10000",
                target_allocation: "TMOS=20;SBER=40;RUB=40"
            };
            
            // –û—á–∏—â–∞–µ–º —Ç–µ–∫—É—â–∏–µ –∞–∫—Ç–∏–≤—ã
            currentAssetsContainer.innerHTML = '';
            targetAssetsContainer.innerHTML = '';
            
            // –î–æ–±–∞–≤–ª—è–µ–º –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
            parseAllocation(demoData.cur_allocation).forEach(asset => {
                addAssetInput(currentAssetsContainer, 'current', asset.ticker, asset.value);
            });
            
            parseAllocation(demoData.target_allocation).forEach(asset => {
                addAssetInput(targetAssetsContainer, 'target', asset.ticker, asset.value);
            });
            
            showOutputModal('–ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö', '–î–∞–Ω–Ω—ã–µ —É—Å–ø–µ—à–Ω–æ –∑–∞–≥—Ä—É–∂–µ–Ω—ã —Å —Å–µ—Ä–≤–µ—Ä–∞.');
        }

        function handleCalculate() {
            if (currentAssets.length === 0 || targetAssets.length === 0) {
                alert('–î–æ–±–∞–≤—å—Ç–µ –¥–∞–Ω–Ω—ã–µ –æ —Ç–µ–∫—É—â–∏—Ö –∏ —Ü–µ–ª–µ–≤—ã—Ö –∞–∫—Ç–∏–≤–∞—Ö');
                return;
            }
            
            const data = {
                cur_allocation: formatAllocation(currentAssets),
                target_allocation: formatAllocation(targetAssets)
            };
            
            console.log('–û—Ç–ø—Ä–∞–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è —Ä–∞—Å—á–µ—Ç–∞:', data);
            
            // –í —Ä–µ–∞–ª—å–Ω–æ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ –∑–¥–µ—Å—å –±—ã–ª –±—ã fetch –∑–∞–ø—Ä–æ—Å
            // simulateApiCall('calc', data);
            
            // –î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–æ–Ω–Ω—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç
            const demoResult = `–ê–∫—Ç—É–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –ø–æ –≤–∞—à–∏–º –∞–∫—Ç–∏–≤–∞–º:\n
TMOS: –¶–µ–Ω–∞: 7.09, –ü–æ–ª–Ω–∞—è —Å—Ç–æ–∏–º–æ—Å—Ç—å –æ–¥–Ω–æ–≥–æ –ª–æ—Ç–∞: 7.09
SBER: –¶–µ–Ω–∞: 325.30, –ü–æ–ª–Ω–∞—è —Å—Ç–æ–∏–º–æ—Å—Ç—å –æ–¥–Ω–æ–≥–æ –ª–æ—Ç–∞: 3253.00
RUB: –¶–µ–Ω–∞: 1.00, –ü–æ–ª–Ω–∞—è —Å—Ç–æ–∏–º–æ—Å—Ç—å –æ–¥–Ω–æ–≥–æ –ª–æ—Ç–∞: 1.00

–°–æ–≤–æ–∫—É–ø–Ω–∞—è —Å—Ç–æ–∏–º–æ—Å—Ç—å –∞–∫—Ç–∏–≤–æ–≤ —Å —É—á—ë—Ç–æ–º –ø–æ–ø–æ–ª–Ω–µ–Ω–∏—è: 149807.00 RUB
–ü—Ä–æ–¥–∞—Ç—å 4154 –ª–æ—Ç–æ–≤ TMOS (4154 —à—Ç—É–∫)
–ö—É–ø–∏—Ç—å 9 –ª–æ—Ç–æ–≤ SBER (90 —à—Ç—É–∫)

–ò—Ç–æ–≥–æ–≤–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –∞–∫—Ç–∏–≤–æ–≤:
TMOS: 12846 (‚âà60.80%)
SBER: 180 (‚âà39.09%)
RUB: 174.86 (‚âà0.12%)`;
            
            showOutputModal('–†–µ–∑—É–ª—å—Ç–∞—Ç —Ä–µ–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∏', demoResult);
        }
    </script>
</body>
</html>